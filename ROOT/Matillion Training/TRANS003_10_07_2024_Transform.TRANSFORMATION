{"job":{"components":{"6234":{"id":6234,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":-1344,"y":-272,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[6246,6247,6249,6250,6273,6276,6277],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BANK TXNS INPUT TABLE"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BANKTRXN_NEW"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"txn_id"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"account_id"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"date"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"type"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"operation"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"amount"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"balance"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"purpose"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"bank"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"account"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STAGE_BANK"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BANKING"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"6235":{"id":6235,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1701703136,"x":-1120,"y":-480,"width":32,"height":32,"inputConnectorIDs":[6246],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Aggregate - Accounts count by trxn id"}}}},"visible":true},"2":{"slot":2,"name":"Groupings","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"account_id"}}}},"visible":true},"3":{"slot":3,"name":"Aggregations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"txn_id"},"2":{"slot":2,"type":"STRING","value":"Count Distinct"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"balance"},"2":{"slot":2,"type":"STRING","value":"Sum"}}}},"visible":true},"4":{"slot":4,"name":"Grouping Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Group By"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"6236":{"id":6236,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1701703136,"x":-880,"y":-384,"width":32,"height":32,"inputConnectorIDs":[6274],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Aggregate - Count of year with balance sum"}}}},"visible":true},"2":{"slot":2,"name":"Groupings","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TXN_YEAR"}}}},"visible":true},"3":{"slot":3,"name":"Aggregations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"txn_id"},"2":{"slot":2,"type":"STRING","value":"Count Distinct"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"balance"},"2":{"slot":2,"type":"STRING","value":"Sum"}}}},"visible":true},"4":{"slot":4,"name":"Grouping Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Group By"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"6237":{"id":6237,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":-1040,"y":-384,"width":32,"height":32,"inputConnectorIDs":[6250],"outputConnectorIDs":[6274],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Converting Date to Year"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"YEAR(\"date\")"},"2":{"slot":2,"type":"STRING","value":"TXN_YEAR"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"6238":{"id":6238,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1838652813,"x":-1040,"y":-272,"width":32,"height":32,"inputConnectorIDs":[6276],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Convert Data type from Date To TimeStamp for Date column"}}}},"visible":true},"2":{"slot":2,"name":"Conversions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"date"},"2":{"slot":2,"type":"STRING","value":"TIMESTAMP_NTZ"},"3":{"slot":3,"type":"INTEGER","value":""},"4":{"slot":4,"type":"INTEGER","value":""}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"balance"},"2":{"slot":2,"type":"STRING","value":"FLOAT"},"3":{"slot":3,"type":"INTEGER","value":"10"},"4":{"slot":4,"type":"INTEGER","value":"2"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"6239":{"id":6239,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1701703136,"x":-880,"y":-160,"width":32,"height":32,"inputConnectorIDs":[6275],"outputConnectorIDs":[6272],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Aggregate  BANK"}}}},"visible":true},"2":{"slot":2,"name":"Groupings","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TXN_YEAR"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"TXN_QTR"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"TXN_MNTH"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"bank"}}}},"visible":true},"3":{"slot":3,"name":"Aggregations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"txn_id"},"2":{"slot":2,"type":"STRING","value":"Count Distinct"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"balance"},"2":{"slot":2,"type":"STRING","value":"Sum"}}}},"visible":true},"4":{"slot":4,"name":"Grouping Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Group By"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"6240":{"id":6240,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":-1040,"y":-160,"width":32,"height":32,"inputConnectorIDs":[6247],"outputConnectorIDs":[6275],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Converting Date to Month, Qtr and Year"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"YEAR(\"date\")"},"2":{"slot":2,"type":"STRING","value":"TXN_YEAR"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"QUARTER(\"date\")"},"2":{"slot":2,"type":"STRING","value":"TXN_QTR"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"MONTH(\"date\")"},"2":{"slot":2,"type":"STRING","value":"TXN_MNTH"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"6241":{"id":6241,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":128170095,"x":-592,"y":-160,"width":32,"height":32,"inputConnectorIDs":[6248],"outputConnectorIDs":[6430],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Rename Components"}}}},"visible":true},"2":{"slot":2,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"bank"},"2":{"slot":2,"type":"STRING","value":"BANK"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"TXN_YEAR"},"2":{"slot":2,"type":"STRING","value":"YEAR"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"count_distinct_txn_id"},"2":{"slot":2,"type":"STRING","value":"Total Txns"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"ROUND_BALANCE"},"2":{"slot":2,"type":"STRING","value":"Total Balance"}}}},"visible":true},"3":{"slot":3,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"6242":{"id":6242,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":-736,"y":-160,"width":32,"height":32,"inputConnectorIDs":[6272],"outputConnectorIDs":[6248],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Calculate Balance"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CAST(CAST(\"sum_balance\"  AS NUMERIC(16,0)) AS bigint)"},"2":{"slot":2,"type":"STRING","value":"ROUND_BALANCE"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"6243":{"id":6243,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1593650416,"x":-1344,"y":-48,"width":32,"height":32,"inputConnectorIDs":[6249],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Next Day Balance"}}}},"visible":true},"2":{"slot":2,"name":"Include input columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Partition Data","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"account_id"}}}},"visible":true},"4":{"slot":4,"name":"Ordering within partitions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"date"},"2":{"slot":2,"type":"STRING","value":"Asc"}}}},"visible":true},"5":{"slot":5,"name":"Functions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Lead"},"2":{"slot":2,"type":"STRING","value":"balance"},"3":{"slot":3,"type":"INTEGER","value":"1"},"4":{"slot":4,"type":"STRING","value":"NEXT_DAY_BALANCE"}}}},"visible":true},"6":{"slot":6,"name":"Ignore Nulls","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"6244":{"id":6244,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1593650416,"x":-1120,"y":-64,"width":32,"height":32,"inputConnectorIDs":[6273],"outputConnectorIDs":[6270],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Previous Day Balance"}}}},"visible":true},"2":{"slot":2,"name":"Include input columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Partition Data","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"account_id"}}}},"visible":true},"4":{"slot":4,"name":"Ordering within partitions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"date"},"2":{"slot":2,"type":"STRING","value":"Desc"}}}},"visible":true},"5":{"slot":5,"name":"Functions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Lag"},"2":{"slot":2,"type":"STRING","value":"balance"},"3":{"slot":3,"type":"INTEGER","value":"1"},"4":{"slot":4,"type":"STRING","value":"PREV_DAY_BALANCE"}}}},"visible":true},"6":{"slot":6,"name":"Ignore Nulls","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"6245":{"id":6245,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1701703136,"x":-1344,"y":-480,"width":32,"height":32,"inputConnectorIDs":[6277],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Aggregate - bank count by trxn id"}}}},"visible":true},"2":{"slot":2,"name":"Groupings","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"bank"}}}},"visible":true},"3":{"slot":3,"name":"Aggregations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"txn_id"},"2":{"slot":2,"type":"STRING","value":"Count Distinct"}}}},"visible":true},"4":{"slot":4,"name":"Grouping Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Group By"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"6268":{"id":6268,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":-960,"y":-64,"width":32,"height":32,"inputConnectorIDs":[6270],"outputConnectorIDs":[6526],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Calculating current balance"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CASE \n\tWHEN \"PREV_DAY_BALANCE\" IS NULL\n    THEN 0\n    ELSE \"balance\"-\"PREV_DAY_BALANCE\"\nEND"},"2":{"slot":2,"type":"STRING","value":"CURRENT_BALANCE"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"6429":{"id":6429,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-319648201,"x":-464,"y":-160,"width":32,"height":32,"inputConnectorIDs":[6430],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Create View 0"}}}},"visible":true},"2":{"slot":2,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"3":{"slot":3,"name":"View Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TEST"}}}},"visible":true},"5":{"slot":5,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"6":{"slot":6,"name":"Secure View","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"7":{"slot":7,"name":"View Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Materialized"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"6524":{"id":6524,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1802397,"x":-812,"y":-72,"width":32,"height":32,"inputConnectorIDs":[6526],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Map Values 0"}}}},"visible":true},"2":{"slot":2,"name":"Value Map","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_BALANCE"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Less than"},"4":{"slot":4,"type":"STRING","value":"0"},"5":{"slot":5,"type":"STRING","value":"Netgative Balance"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_BALANCE"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Greater than"},"4":{"slot":4,"type":"STRING","value":"0"},"5":{"slot":5,"type":"STRING","value":"Positive Balance"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_BALANCE"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"0"},"5":{"slot":5,"type":"STRING","value":"No Change in Balance"}}}},"visible":true},"3":{"slot":3,"name":"Other","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"o"}}}},"visible":true},"4":{"slot":4,"name":"Column Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Test"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"6637":{"id":6637,"inputCardinality":"TWO","outputCardinality":"MANY","implementationID":-359894709,"x":-1508,"y":-325,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Detect Changes 0"}}}},"visible":true},"2":{"slot":2,"name":"Master Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"3":{"slot":3,"name":"Match Keys","elements":{},"visible":true},"4":{"slot":4,"name":"Compare Columns","elements":{},"visible":true},"5":{"slot":5,"name":"Output Column Mapping","elements":{},"visible":true},"6":{"slot":6,"name":"Indicator Column","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Indicator"}}}},"visible":true},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"6246":{"id":6246,"sourceID":6234,"targetID":6235},"6247":{"id":6247,"sourceID":6234,"targetID":6240},"6248":{"id":6248,"sourceID":6242,"targetID":6241},"6249":{"id":6249,"sourceID":6234,"targetID":6243},"6250":{"id":6250,"sourceID":6234,"targetID":6237},"6270":{"id":6270,"sourceID":6244,"targetID":6268},"6272":{"id":6272,"sourceID":6239,"targetID":6242},"6273":{"id":6273,"sourceID":6234,"targetID":6244},"6274":{"id":6274,"sourceID":6237,"targetID":6236},"6275":{"id":6275,"sourceID":6240,"targetID":6239},"6276":{"id":6276,"sourceID":6234,"targetID":6238},"6277":{"id":6277,"sourceID":6234,"targetID":6245},"6430":{"id":6430,"sourceID":6241,"targetID":6429},"6526":{"id":6526,"sourceID":6268,"targetID":6524}},"notes":{},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"TRANS003_10_07_2024_Transform","description":"This will be having all the transformation jobs for DDL","type":"TRANSFORMATION","tag":"bb97767c-88af-443e-b23a-bafedbfa275a"}}